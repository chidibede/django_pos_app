{% extends 'pointofsale/mainapp_layout.html' %}

{% block title %} Sales Report {% endblock title %}

{% block content %} 
<!-- Start of inventory table -->
<section>
    <div class="container" id="myDIV">
        {% if selected_month %}

        <div class="row">
            <div class="col-12">    
                <h3 class='text-center text-muted inventory-heading'>Sales Report</h3>
                <h2 class="text-center">Report for the month of {{selected_month}}</h2>
            </div>
            <form action="{% url 'filter_date' %}" method="GET" class="form-horizontal">
                    <div class="form-group">
                        <label for="month" class="ml-3">Choose a Month:</label>
                        <div class="input-group">
                            
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            
                            <select name="month" id="month" class="form-control-lg ml-3">
                                <option value="January">January</option>
                                <option value="February">February</option>
                                <option value="March">March</option>
                                <option value="April">April</option>
                                <option value="May">May</option>
                                <option value="June">June</option>
                                <option value="July">July</option>
                                <option value="August">August</option>
                                <option value="September">September</option>
                                <option value="October">October</option>
                                <option value="November">November</option>
                                <option value="December">December</option>
                            </select>
                            <button class="ml-2 btn btn-primary pl-4 pr-4" style="border-radius: 24px; font-size: large;" type="submit">Filter</button>
                        </div>
                    </div>

            </form>
            
        </div>
        
        <div class="row">
            <div class="col-12">
                <table class="table table-striped table-bordered mydatatable bg-light">
                    
                    <thead>
                    <tr>
                        <th scope="col" class="text-center">#</th>
                        <th scope="col" class="text-center"> Date</th>
                        <th scope="col" class="text-center"> Month</th>
                        <th scope="col" class="text-center">Product</th>
                        <th scope="col" class="text-center">Category</th>
                        <th scope="col" class="text-center">Quantity</th>
                        <th scope="col" class="text-center">Price</th>
                        <th scope="col" class="text-center">Total Price</th>
                        <th scope="col" class="text-center">staff</th>
                    </tr>
                    </thead>

                    <tbody>
                    
                     
                    <tr>
                        {% for purchase in purchases %}
                        {% if purchase.purchased %}
                        <th scope="row">{{ purchase.id }}</th>
                        <td class="text-center">{{ purchase.date_added }}</td class="text-center">
                        <td class="text-center">{{ purchase.get_month }}</td class="text-center">
                        <td class="text-center">{{ purchase.product }}</td class="text-center">
                        <td class="text-center">{{ purchase.product.category }}</td class="text-center">
                        <td class="text-center">{{ purchase.quantity }}</td class="text-center">
                        <td class="text-center">{{ purchase.product.selling_price  }}</td class="text-center">
                        <td class="text-center">{{ purchase.get_total_item_price }}</td class="text-center">
                        <td class="text-center">{{ purchase.user }}</td class="text-center">
                    </tr>
                    {% endif %}
                    {% endfor %}
                    </tbody>
                </table>
                
            </div>
        </div>
        <h3>Total Sales: &#x20A6;  {{ total_sales_by_month }}</h3>
    </div>

    {% else %}
            <div class="row">
                <div class="col-12">    
                    <h3 class='text-center text-muted inventory-heading'>Sales Report</h3>
                    <h2>{{selected_month}}</h2>
                </div>
                <form action="{% url 'filter_date' %}" method="GET" class="form-horizontal">
                        <div class="form-group">
                            <label for="month" class="ml-3">Choose a Month:</label>
                            <div class="input-group">
                                
                                <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                                
                                <select name="month" id="month" class="form-control-lg ml-3">
                                    <option value="January">January</option>
                                    <option value="February">February</option>
                                    <option value="March">March</option>
                                    <option value="April">April</option>
                                    <option value="May">May</option>
                                    <option value="June">June</option>
                                    <option value="July">July</option>
                                    <option value="August">August</option>
                                    <option value="September">September</option>
                                    <option value="October">October</option>
                                    <option value="November">November</option>
                                    <option value="December">December</option>
                                </select>
                                <button class="ml-2 btn btn-primary pl-4 pr-4" style="border-radius: 24px; font-size: large;" type="submit">Filter</button>
                            </div>
                        </div>

                </form>
                
            </div>
            
            <div class="row">
                <div class="col-12">
                    <table class="table table-striped table-bordered mydatatable bg-light">
                        
                        <thead>
                        <tr>
                            <th scope="col" class="text-center">#</th>
                            <th scope="col" class="text-center"> Date</th>
                            <th scope="col" class="text-center"> Month</th>
                            <th scope="col" class="text-center">Product</th>
                            <th scope="col" class="text-center">Category</th>
                            <th scope="col" class="text-center">Quantity</th>
                            <th scope="col" class="text-center">Price</th>
                            <th scope="col" class="text-center">Total Price</th>
                            <th scope="col" class="text-center">staff</th>
                        </tr>
                        </thead>

                        <tbody>
                        
                        
                        <tr>
                            {% for purchase in purchases %}
                            {% if purchase.purchased %}
                            <th scope="row">{{ purchase.id }}</th>
                            <td class="text-center">{{ purchase.date_added }}</td class="text-center">
                            <td class="text-center">{{ purchase.get_month }}</td class="text-center">
                            <td class="text-center">{{ purchase.product }}</td class="text-center">
                            <td class="text-center">{{ purchase.product.category }}</td class="text-center">
                            <td class="text-center">{{ purchase.quantity }}</td class="text-center">
                            <td class="text-center">{{ purchase.product.selling_price  }}</td class="text-center">
                            <td class="text-center">{{ purchase.get_total_item_price }}</td class="text-center">
                            <td class="text-center">{{ purchase.user }}</td class="text-center">
                        </tr>
                        {% endif %}
                        {% endfor %}
                        </tbody>
                    </table>
                    
                </div>
            </div>
            <h3>Total Sales: &#x20A6;  {{ total_sales }}</h3>
        </div>
    {% endif %}
    
    
</section>



{% endblock %}